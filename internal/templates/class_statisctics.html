<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª–∞—Å—Å–∞</title>
    
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar">
        <a href="/teacher/home" class="nav-brand">üßÆ –ú–∞—Ç–¢—Ä–µ–Ω–∞–∂–µ—Ä</a>
        <div class="nav-links">
            <a href="/teacher/home">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <a href="/logout" class="logout-btn">–í—ã–π—Ç–∏</a>
        </div>
    </nav>

    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="header">
            <h1 class="page-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª–∞—Å—Å–∞</h1>
            <p class="page-subtitle">ID –∫–ª–∞—Å—Å–∞: {{.ClassID}}</p>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="action-buttons">
            <a href="/teacher/home" class="btn btn-back">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–ª–∞—Å—Å–∞–º</a>
        </div>

        <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        {{with .Stats}}
        <div class="stats-grid">
            <div class="stat-card students-stat">
                <div class="stat-icon">üë•</div>
                <div class="stat-value">{{.student_count}}</div>
                <div class="stat-label">–£—á–µ–Ω–∏–∫–æ–≤ –≤ –∫–ª–∞—Å—Å–µ</div>
            </div>
            
            <div class="stat-card attempts-stat">
                <div class="stat-icon">üìù</div>
                <div class="stat-value">{{.total_attempts}}</div>
                <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ø—ã—Ç–æ–∫</div>
            </div>
            
            <div class="stat-card correct-stat">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-value">{{.correct_attempts}}</div>
                <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
            </div>
            
            <div class="stat-card accuracy-stat">
                <div class="stat-icon">üéØ</div>
                <div class="stat-value">{{printf "%.1f" .accuracy_percent}}%</div>
                <div class="stat-label">–û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</div>
            </div>
        </div>
        {{end}}

        <!-- –¢–æ–ø —É—á–µ–Ω–∏–∫–æ–≤ -->
        {{if .Stats.top_students}}
        <div class="top-students">
            <h3>üèÜ –õ—É—á—à–∏–µ —É—á–µ–Ω–∏–∫–∏ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏</h3>
            <div class="top-list">
                {{range .Stats.top_students}}
                <div class="top-item">
                    <div class="top-rank">{{.accuracy}}%</div>
                    <div style="font-weight: bold; margin: 0.5rem 0;">{{.name}}</div>
                    <div style="font-size: 0.9rem; color: #666;">
                        {{.correct}}/{{.total}} –≤–µ—Ä–Ω–æ
                    </div>
                    <a href="/teacher/student?student_id={{.id}}" class="student-link" style="display: inline-block; margin-top: 0.5rem;">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                    </a>
                </div>
                {{end}}
            </div>
        </div>
        {{end}}

        <!-- –£—á–µ–Ω–∏–∫–∏ –∫–ª–∞—Å—Å–∞ -->
        <div class="students-section">
            <h2 class="section-title">üë• –£—á–µ–Ω–∏–∫–∏ –∫–ª–∞—Å—Å–∞</h2>
            {{if .Students}}
            <table class="students-table">
                <thead>
                    <tr>
                        <th>–§–ò–û</th>
                        <th>–õ–æ–≥–∏–Ω</th>
                        <th>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .Students}}
                    <tr>
                        <td>{{.FullName}}</td>
                        <td>{{.Username}}</td>
                        <td>
                            <a href="/teacher/student?student_id={{.ID}}" class="student-link">
                                –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                            </a>
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
            {{else}}
            <p style="text-align: center; color: #7f8c8d; padding: 2rem;">
                –í –∫–ª–∞—Å—Å–µ –ø–æ–∫–∞ –Ω–µ—Ç —É—á–µ–Ω–∏–∫–æ–≤
            </p>
            {{end}}
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —É—Ä–∞–≤–Ω–µ–Ω–∏–π -->
        {{if .Stats.type_statistics}}
        <div class="types-section">
            <h2 class="section-title">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —É—Ä–∞–≤–Ω–µ–Ω–∏–π</h2>
            <div class="types-grid">
                {{range .Stats.type_statistics}}
                <div class="type-card">
                    <div class="type-header">
                        <div class="type-name">{{.type_name}}</div>
                    </div>
                    
                    <div class="type-stats">
                        <div class="type-stat">
                            <div class="type-stat-value">{{.attempts}}</div>
                            <div class="type-stat-label">–ü–æ–ø—ã—Ç–æ–∫</div>
                        </div>
                        <div class="type-stat">
                            <div class="type-stat-value">{{.correct}}</div>
                            <div class="type-stat-label">–í–µ—Ä–Ω–æ</div>
                        </div>
                        <div class="type-stat">
                            <div class="type-stat-value">{{printf "%.1f" .accuracy}}%</div>
                            <div class="type-stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                        </div>
                    </div>
                </div>
                {{end}}
            </div>
        </div>
        {{end}}
    </div>
</body>
</html>